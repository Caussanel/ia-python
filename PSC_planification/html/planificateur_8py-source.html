<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lab 7 : Planification avec PSC:  Fichier source de planificateur.py</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Généré par Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Page&nbsp;principale</span></a></li>
      <li><a href="namespaces.html"><span>Paquetages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Fichiers</span></a></li>
    </ul>
  </div>
<h1>planificateur.py</h1><a href="planificateur_8py.html">Aller à la documentation de ce fichier.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a><a class="code" href="namespaceplanificateur.html">00001</a> <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00002"></a>00002 <span class="keywordflow">print</span> <span class="stringliteral">"Chargement de l'algorithme de planification par PSC"</span>
<a name="l00003"></a>00003 <span class="keywordflow">print</span> <span class="stringliteral">"\t@version: 3.0  date: 07/06/2008 modified by Thomas Leaute"</span>
<a name="l00004"></a>00004 <span class="keywordflow">print</span> <span class="stringliteral">"\t@version: 2.3  date: 31/03/2008 modified by Thomas Leaute"</span>
<a name="l00005"></a>00005 <span class="keywordflow">print</span> <span class="stringliteral">"\t@version: 2.2  date: 28/06/2007 modified by Thomas Leaute"</span>
<a name="l00006"></a>00006 <span class="keywordflow">print</span> <span class="stringliteral">"\t@version: 2.1  date: 04/05/2007 modified by Thomas Leaute"</span>
<a name="l00007"></a>00007 <span class="keywordflow">print</span> <span class="stringliteral">"\t@version: 2.0  date: 03/05/2007 modified by Thomas Leaute"</span>
<a name="l00008"></a>00008 <span class="keywordflow">print</span> <span class="stringliteral">"\t@version: 1.1  date: 02/05/2007 modified by Thomas Leaute"</span>
<a name="l00009"></a>00009 <span class="keywordflow">print</span> <span class="stringliteral">"\t@version: 1.0  date: 05/03/2007 created by Vincent Schickel-Zuber"</span>
<a name="l00010"></a>00010 <span class="keywordflow">print</span> <span class="stringliteral">"\t@author: vincent.schickel-zuber@epfl.ch date: 05/03/2007"</span>
<a name="l00011"></a>00011 <span class="keywordflow">print</span> <span class="stringliteral">"\t@copyright: EPFL-IC-IIF-LIA 2007"</span>
<a name="l00012"></a>00012 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00013"></a>00013 <span class="keyword">import</span> copy
<a name="l00014"></a>00014 <span class="keyword">import</span> libPSC
<a name="l00015"></a>00015 <span class="keyword">import</span> PSC
<a name="l00016"></a>00016 <span class="keyword">import</span> libPlan
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 <span class="comment">## contiennent les variables et les contraintes</span>
<a name="l00020"></a><a class="code" href="namespaceplanificateur.html#16967039a674ca73a5fe7fb2eed191c3">00020</a> VARS = PSC.Variables()
<a name="l00021"></a><a class="code" href="namespaceplanificateur.html#305c94e08beffda0308888ce1360524c">00021</a> CONTS = PSC.Contraintes()
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="comment">## contient la liste de tous les etats</span>
<a name="l00024"></a><a class="code" href="namespaceplanificateur.html#f5fbc363a2eb39088ec14091bf0b7399">00024</a> ETATS = []
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="comment">## Une contrainte d'axiome de cadre pour un etat et une proposition donnes</span>
<a name="l00028"></a><a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html">00028</a> <span class="keyword">class </span><a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html" title="Une contrainte d&amp;#39;axiome de cadre pour un etat et une proposition donnes.">ContrainteAxiomeCadre</a> (libPSC.Contrainte):
<a name="l00029"></a>00029         
<a name="l00030"></a>00030         <span class="comment">## \var varPre </span>
<a name="l00031"></a>00031         <span class="comment"># Variable correspondant a la proposition au debut de l'etat</span>
<a name="l00032"></a>00032         
<a name="l00033"></a>00033         <span class="comment">## \var varPost </span>
<a name="l00034"></a>00034         <span class="comment"># Variable correspondant a la proposition a la fin de l'etat</span>
<a name="l00035"></a>00035         
<a name="l00036"></a>00036         <span class="comment">## \var varsOp</span>
<a name="l00037"></a>00037         <span class="comment"># Liste de variables d'operateurs ayant la proposition representee par \a varPost comme postcondition</span>
<a name="l00038"></a>00038         
<a name="l00039"></a>00039         <span class="comment">## Constructeur de la classe</span>
<a name="l00040"></a>00040         <span class="comment"># </span>
<a name="l00041"></a>00041         <span class="comment"># La contrainte est la suivante : </span>
<a name="l00042"></a>00042         <span class="comment"># SI (\a varPre = \c False ET \a varPost = \c True) </span>
<a name="l00043"></a>00043         <span class="comment"># ALORS au moins une des variables dans \a varsOp est \c True</span>
<a name="l00044"></a>00044         <span class="comment">#</span>
<a name="l00045"></a>00045         <span class="comment"># @param[in] self reference automatique vers l'instance executant cette</span>
<a name="l00046"></a>00046         <span class="comment">#                                methode.</span>
<a name="l00047"></a>00047         <span class="comment"># @param[in] varPre variable correspondant a la proposition au debut de l'etat</span>
<a name="l00048"></a>00048         <span class="comment"># @param[in] varsOp liste de variables d'operateurs ayant la proposition representee par \a varPost </span>
<a name="l00049"></a>00049         <span class="comment">#                                       comme postcondition</span>
<a name="l00050"></a>00050         <span class="comment"># @param[in] varPost variable correspondant a la proposition a la fin de l'etat</span>
<a name="l00051"></a><a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#81ac883e76419867eba46eea03353a97">00051</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#81ac883e76419867eba46eea03353a97" title="Constructeur de la classe.">__init__</a>( self, varPre, varsOp, varPost ):
<a name="l00052"></a>00052                 libPSC.Contrainte.__init__(self, [varPre.nom, varPost.nom] + [ varOp.nom <span class="keywordflow">for</span> varOp <span class="keywordflow">in</span> varsOp ])
<a name="l00053"></a><a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#02188bfe3869a8aef22c1f78d8eb2c31">00053</a>                 self.<a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#02188bfe3869a8aef22c1f78d8eb2c31" title="Variable correspondant a la proposition au debut de l&amp;#39;etat.">varPre</a> = varPre
<a name="l00054"></a><a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#95ba3d78e1eb8258f4332f01dd5927d7">00054</a>                 self.<a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#95ba3d78e1eb8258f4332f01dd5927d7" title="Liste de variables d&amp;#39;operateurs ayant la proposition representee par varPost...">varsOp</a> = varsOp
<a name="l00055"></a><a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#e5faf5fa269df43b5743c80db6a55e67">00055</a>                 self.<a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#e5faf5fa269df43b5743c80db6a55e67" title="Variable correspondant a la proposition a la fin de l&amp;#39;etat.">varPost</a> = varPost
<a name="l00056"></a>00056 
<a name="l00057"></a>00057         <span class="comment"># Retourne la dimension de la contrainte</span>
<a name="l00058"></a><a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#e6f845d356065283628f2dc9b76e79c5">00058</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#e6f845d356065283628f2dc9b76e79c5" title="Retourne la dimension de la contrainte.">dimension</a>( self ):
<a name="l00059"></a>00059                 <span class="keywordflow">return</span> len( self.<a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#95ba3d78e1eb8258f4332f01dd5927d7" title="Liste de variables d&amp;#39;operateurs ayant la proposition representee par varPost...">varsOp</a> ) + 2
<a name="l00060"></a>00060 
<a name="l00061"></a>00061         <span class="comment"># Teste si la contrainte est valide et respectee par les valeurs des variables qui la composent.</span>
<a name="l00062"></a><a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#41e2bb4e16704362703926bc2a231e74">00062</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#41e2bb4e16704362703926bc2a231e74" title="Teste si la contrainte est valide et respectee par les valeurs de la/ des variable(s)...">estValide</a>( self, var, val ):
<a name="l00063"></a>00063         
<a name="l00064"></a>00064                 <span class="comment"># incremente le nombre de contraintes visitees</span>
<a name="l00065"></a>00065                 libPSC.NBCONTRAINTES += 1
<a name="l00066"></a>00066                 
<a name="l00067"></a>00067                 <span class="comment"># sauvegarde la valeur de la variable val avant de la modifier</span>
<a name="l00068"></a>00068                 valeur = var.valeur
<a name="l00069"></a>00069                 var.metAJourValeur(val)
<a name="l00070"></a>00070                 
<a name="l00071"></a>00071                 valide = <span class="keyword">False</span>
<a name="l00072"></a>00072                 
<a name="l00073"></a>00073                 <span class="comment"># Si au moins une des variables n'est pas encore instanciee, retourne True</span>
<a name="l00074"></a>00074                 <span class="keywordflow">for</span> var2 <span class="keywordflow">in</span> [ self.<a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#02188bfe3869a8aef22c1f78d8eb2c31" title="Variable correspondant a la proposition au debut de l&amp;#39;etat.">varPre</a>, self.<a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#e5faf5fa269df43b5743c80db6a55e67" title="Variable correspondant a la proposition a la fin de l&amp;#39;etat.">varPost</a> ] + self.<a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#95ba3d78e1eb8258f4332f01dd5927d7" title="Liste de variables d&amp;#39;operateurs ayant la proposition representee par varPost...">varsOp</a>:
<a name="l00075"></a>00075                         <span class="keywordflow">if</span> var2.valeur == <span class="keywordtype">None</span>:
<a name="l00076"></a>00076                                 valide = <span class="keyword">True</span>
<a name="l00077"></a>00077                                 <span class="keywordflow">break</span>
<a name="l00078"></a>00078                 
<a name="l00079"></a>00079                 <span class="comment"># Si toutes les variables sont intanciees, verifie que la contrainte est satisfaite</span>
<a name="l00080"></a>00080                 <span class="keywordflow">if</span> <span class="keywordflow">not</span> valide:
<a name="l00081"></a>00081                 
<a name="l00082"></a>00082                         <span class="comment"># Verifie si la proposition passe de False a True</span>
<a name="l00083"></a>00083                         <span class="keywordflow">if</span> self.<a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#02188bfe3869a8aef22c1f78d8eb2c31" title="Variable correspondant a la proposition au debut de l&amp;#39;etat.">varPre</a>.valeur == <span class="keyword">False</span> <span class="keywordflow">and</span> self.<a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#e5faf5fa269df43b5743c80db6a55e67" title="Variable correspondant a la proposition a la fin de l&amp;#39;etat.">varPost</a>.valeur == <span class="keyword">True</span>:
<a name="l00084"></a>00084                                 
<a name="l00085"></a>00085                                 <span class="comment"># Verifie si au moins un des operateurs est applique</span>
<a name="l00086"></a>00086                                 <span class="keywordflow">for</span> varOp <span class="keywordflow">in</span> self.<a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#95ba3d78e1eb8258f4332f01dd5927d7" title="Liste de variables d&amp;#39;operateurs ayant la proposition representee par varPost...">varsOp</a>:
<a name="l00087"></a>00087                                         <span class="keywordflow">if</span> varOp.valeur == <span class="keyword">True</span>:
<a name="l00088"></a>00088                                                 valide = <span class="keyword">True</span>
<a name="l00089"></a>00089                                                 <span class="keywordflow">break</span>
<a name="l00090"></a>00090                                 
<a name="l00091"></a>00091                         <span class="keywordflow">else</span>:
<a name="l00092"></a>00092                                 valide = <span class="keyword">True</span>
<a name="l00093"></a>00093                         
<a name="l00094"></a>00094                 <span class="comment"># annule le changement de valeur de la variable var et retourne</span>
<a name="l00095"></a>00095                 var.metAJourValeur(valeur)
<a name="l00096"></a>00096                 <span class="keywordflow">return</span> valide
<a name="l00097"></a>00097         
<a name="l00098"></a>00098         
<a name="l00099"></a>00099         <span class="comment">## Propage l'assignation d'une variable de la contrainte aux autres variables non instanciees</span>
<a name="l00100"></a>00100         <span class="comment">#</span>
<a name="l00101"></a>00101         <span class="comment"># Etant donne qu'on a fixe une valeur pour une variable de cette contrainte, </span>
<a name="l00102"></a>00102         <span class="comment"># on essaie de reduire le label des autres en supprimant les valeurs inconsistantes. </span>
<a name="l00103"></a>00103         <span class="comment">#</span>
<a name="l00104"></a>00104         <span class="comment"># Propagation paresseuse : appliquee seulement s'il ne reste qu'une variable non instanciee</span>
<a name="l00105"></a>00105         <span class="comment">#</span>
<a name="l00106"></a>00106         <span class="comment"># @param[in] self reference automatique vers l'instance executant cette</span>
<a name="l00107"></a>00107         <span class="comment">#                                methode.</span>
<a name="l00108"></a>00108         <span class="comment"># @param[in] var la variable qui vient d'etre instanciee</span>
<a name="l00109"></a>00109         <span class="comment"># @return True si apres propagation, la contrainte est toujours consistante</span>
<a name="l00110"></a><a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#b6cda66d08f873f317bd34628dcf5c6c">00110</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#b6cda66d08f873f317bd34628dcf5c6c" title="Propage l&amp;#39;assignation d&amp;#39;une variable de la contrainte aux autres variables...">propage</a> ( self, var ):
<a name="l00111"></a>00111                 
<a name="l00112"></a>00112                 <span class="comment"># Obtient la derniere variable non encore instanciee</span>
<a name="l00113"></a>00113                 derniereVar = <span class="keywordtype">None</span>
<a name="l00114"></a>00114                 <span class="keywordflow">for</span> var2 <span class="keywordflow">in</span> [ self.<a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#02188bfe3869a8aef22c1f78d8eb2c31" title="Variable correspondant a la proposition au debut de l&amp;#39;etat.">varPre</a>, self.<a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#e5faf5fa269df43b5743c80db6a55e67" title="Variable correspondant a la proposition a la fin de l&amp;#39;etat.">varPost</a> ] + self.<a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#95ba3d78e1eb8258f4332f01dd5927d7" title="Liste de variables d&amp;#39;operateurs ayant la proposition representee par varPost...">varsOp</a>:
<a name="l00115"></a>00115                         <span class="keywordflow">if</span> var2.valeur == <span class="keywordtype">None</span>:
<a name="l00116"></a>00116                                 <span class="keywordflow">if</span> derniereVar == <span class="keywordtype">None</span>:
<a name="l00117"></a>00117                                         derniereVar = var2
<a name="l00118"></a>00118                                 <span class="keywordflow">else</span>:
<a name="l00119"></a>00119                                         <span class="comment"># Il reste plus d'une variable non instanciee</span>
<a name="l00120"></a>00120                                         <span class="keywordflow">return</span> <span class="keyword">True</span>
<a name="l00121"></a>00121                 
<a name="l00122"></a>00122                 <span class="comment"># utilise le label de la variable derniereVar</span>
<a name="l00123"></a>00123                 <span class="keywordflow">for</span> l <span class="keywordflow">in</span> derniereVar.label[:]:
<a name="l00124"></a>00124 
<a name="l00125"></a>00125                         <span class="comment">#verifie que la contrainte est satisfaite</span>
<a name="l00126"></a>00126                         <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.<a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#41e2bb4e16704362703926bc2a231e74" title="Teste si la contrainte est valide et respectee par les valeurs de la/ des variable(s)...">estValide</a>( derniereVar, l ):
<a name="l00127"></a>00127                                 <span class="comment"># on enleve la valeur l du label</span>
<a name="l00128"></a>00128                                 derniereVar.enleveDuLabel(l)
<a name="l00129"></a>00129                 
<a name="l00130"></a>00130                 <span class="comment"># la consistance est possibe &lt;=&gt; il reste au moins une valeur dans le label</span>
<a name="l00131"></a>00131                 <span class="keywordflow">return</span> len(derniereVar.label) &gt; 0
<a name="l00132"></a>00132 
<a name="l00133"></a>00133                 
<a name="l00134"></a>00134         <span class="comment">## L'algorithme REVISER n'est pas defini pour des contraintes n-aires</span>
<a name="l00135"></a><a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#fbb941a0ae218353029eddd13fa287d3">00135</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#fbb941a0ae218353029eddd13fa287d3" title="L&amp;#39;algorithme REVISER n&amp;#39;est pas defini pour des contraintes n-aires.">reviser</a> ( self ):
<a name="l00136"></a>00136                 <span class="keywordflow">return</span> <span class="keyword">False</span>
<a name="l00137"></a>00137         
<a name="l00138"></a>00138         <span class="comment"># Retourne une representation textuelle des donnees de la classe</span>
<a name="l00139"></a><a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#c8950120a1ea70862ee769823c57d10c">00139</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#c8950120a1ea70862ee769823c57d10c" title="Retourne une representation textuelle des donnees de la classe.">__repr__</a>(self):
<a name="l00140"></a>00140                 str = <span class="stringliteral">"Axiome de cadre : %s = False \t/\t %s \t/\t %s = True"</span> % (self.<a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#02188bfe3869a8aef22c1f78d8eb2c31" title="Variable correspondant a la proposition au debut de l&amp;#39;etat.">varPre</a>.nom, [ varOp.nom <span class="keywordflow">for</span> varOp <span class="keywordflow">in</span> self.<a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#95ba3d78e1eb8258f4332f01dd5927d7" title="Liste de variables d&amp;#39;operateurs ayant la proposition representee par varPost...">varsOp</a> ], self.<a class="code" href="classplanificateur_1_1_contrainte_axiome_cadre.html#e5faf5fa269df43b5743c80db6a55e67" title="Variable correspondant a la proposition a la fin de l&amp;#39;etat.">varPost</a>.nom)
<a name="l00141"></a>00141                 <span class="keywordflow">return</span> str              
<a name="l00142"></a>00142 
<a name="l00143"></a>00143 
<a name="l00144"></a>00144 <span class="comment">## Cette classe represente un etat de planification</span>
<a name="l00145"></a>00145 <span class="comment">#</span>
<a name="l00146"></a>00146 <span class="comment"># Un etat contient une liste de propositions utilisees comme pre- et postconditions, et une liste d'operateurs  </span>
<a name="l00147"></a><a class="code" href="classplanificateur_1_1_etat.html">00147</a> <span class="keyword">class </span><a class="code" href="classplanificateur_1_1_etat.html" title="Cette classe represente un etat de planification.">Etat</a>:
<a name="l00148"></a>00148 
<a name="l00149"></a>00149         <span class="comment">## \var varInitiales </span>
<a name="l00150"></a>00150         <span class="comment"># dictionnaire { nom de proposition : variable de proposition }</span>
<a name="l00151"></a>00151 
<a name="l00152"></a>00152         <span class="comment">## \var varFinales </span>
<a name="l00153"></a>00153         <span class="comment"># dictionnaire { nom de proposition : variable de proposition }</span>
<a name="l00154"></a>00154         
<a name="l00155"></a>00155         <span class="comment">## \var varOperateurs </span>
<a name="l00156"></a>00156         <span class="comment"># dictionnaire { nom de l'operateur : variable d'operateur }</span>
<a name="l00157"></a>00157 
<a name="l00158"></a>00158         <span class="comment">## \var no_etat </span>
<a name="l00159"></a>00159         <span class="comment"># numero de cet etat</span>
<a name="l00160"></a>00160         
<a name="l00161"></a>00161         <span class="comment">## constructeur</span>
<a name="l00162"></a>00162         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00163"></a>00163         <span class="comment"># @param no_etat le numero de l'etat [0,PlanificateurPSC.nb_etats)</span>
<a name="l00164"></a>00164         <span class="comment"># @param props La liste des propositions de planification </span>
<a name="l00165"></a>00165         <span class="comment"># @param ops La liste des operateurs de planification </span>
<a name="l00166"></a><a class="code" href="classplanificateur_1_1_etat.html#d8c792658a3689d8cc0265b08fe7b84a">00166</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_etat.html#d8c792658a3689d8cc0265b08fe7b84a" title="constructeur">__init__</a>(self, no_etat, props, ops):
<a name="l00167"></a><a class="code" href="classplanificateur_1_1_etat.html#1ff6e1d23726a7782fd0da2260592dbf">00167</a>                 self.<a class="code" href="classplanificateur_1_1_etat.html#1ff6e1d23726a7782fd0da2260592dbf" title="numero de cet etat">no_etat</a>=no_etat
<a name="l00168"></a><a class="code" href="classplanificateur_1_1_etat.html#2941298dab0a04ad2e25795a026de7fa">00168</a>                 self.<a class="code" href="classplanificateur_1_1_etat.html#2941298dab0a04ad2e25795a026de7fa" title="dictionnaire { nom de proposition : variable de proposition }">varInitiales</a> = {}
<a name="l00169"></a><a class="code" href="classplanificateur_1_1_etat.html#3e7203a87ad084a468ed6a952f56c6f0">00169</a>                 self.<a class="code" href="classplanificateur_1_1_etat.html#3e7203a87ad084a468ed6a952f56c6f0" title="dictionnaire { nom de proposition : variable de proposition }">varFinales</a> = {}
<a name="l00170"></a><a class="code" href="classplanificateur_1_1_etat.html#fe87471e83a345fbb21ac581e924df96">00170</a>                 self.<a class="code" href="classplanificateur_1_1_etat.html#fe87471e83a345fbb21ac581e924df96" title="dictionnaire { nom de l&amp;#39;operateur : variable d&amp;#39;operateur }">varOperateurs</a> = {}
<a name="l00171"></a>00171                 self.<a class="code" href="classplanificateur_1_1_etat.html#34ce209e811fb777bb0c21998f753127" title="construit une action">construitVariablesOperateurs</a>(ops)
<a name="l00172"></a>00172                 self.<a class="code" href="classplanificateur_1_1_etat.html#5ca929135151ef29bb7f44e809d1829d" title="construit toutes les propositions et les ajoute aux dictionnaires varInitiales et...">construitVariablesPropositions</a>(props)
<a name="l00173"></a>00173 
<a name="l00174"></a>00174         <span class="comment">##construit une action</span>
<a name="l00175"></a>00175         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00176"></a>00176         <span class="comment"># @param ops La liste des operateurs de planification </span>
<a name="l00177"></a><a class="code" href="classplanificateur_1_1_etat.html#34ce209e811fb777bb0c21998f753127">00177</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_etat.html#34ce209e811fb777bb0c21998f753127" title="construit une action">construitVariablesOperateurs</a>(self, ops):
<a name="l00178"></a>00178                 <span class="keywordflow">for</span> op <span class="keywordflow">in</span> ops:
<a name="l00179"></a>00179                         var = libPSC.Variable(op.nom + <span class="stringliteral">" etat "</span> + str(self.<a class="code" href="classplanificateur_1_1_etat.html#1ff6e1d23726a7782fd0da2260592dbf" title="numero de cet etat">no_etat</a>), [<span class="keyword">True</span>, <span class="keyword">False</span>])
<a name="l00180"></a>00180                         self.<a class="code" href="classplanificateur_1_1_etat.html#fe87471e83a345fbb21ac581e924df96" title="dictionnaire { nom de l&amp;#39;operateur : variable d&amp;#39;operateur }">varOperateurs</a>[op.nom] = var
<a name="l00181"></a>00181                         VARS.ajouteVar(var)
<a name="l00182"></a>00182 
<a name="l00183"></a>00183         <span class="comment">##construit toutes les propositions et les ajoute aux dictionnaires varInitiales et varFinales</span>
<a name="l00184"></a>00184         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00185"></a>00185         <span class="comment"># @param props La liste des propositions de planification </span>
<a name="l00186"></a><a class="code" href="classplanificateur_1_1_etat.html#5ca929135151ef29bb7f44e809d1829d">00186</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_etat.html#5ca929135151ef29bb7f44e809d1829d" title="construit toutes les propositions et les ajoute aux dictionnaires varInitiales et...">construitVariablesPropositions</a>(self, props):
<a name="l00187"></a>00187                 <span class="keywordflow">if</span> self.<a class="code" href="classplanificateur_1_1_etat.html#1ff6e1d23726a7782fd0da2260592dbf" title="numero de cet etat">no_etat</a>&gt;0:
<a name="l00188"></a>00188                         self.<a class="code" href="classplanificateur_1_1_etat.html#2941298dab0a04ad2e25795a026de7fa" title="dictionnaire { nom de proposition : variable de proposition }">varInitiales</a> = ETATS[self.<a class="code" href="classplanificateur_1_1_etat.html#1ff6e1d23726a7782fd0da2260592dbf" title="numero de cet etat">no_etat</a>-1].varFinales
<a name="l00189"></a>00189                 <span class="keywordflow">for</span> prop <span class="keywordflow">in</span> props:
<a name="l00190"></a>00190                         var = libPSC.Variable(prop + <span class="stringliteral">" etat "</span> + str(self.<a class="code" href="classplanificateur_1_1_etat.html#1ff6e1d23726a7782fd0da2260592dbf" title="numero de cet etat">no_etat</a>+1), [<span class="keyword">True</span>, <span class="keyword">False</span>])
<a name="l00191"></a>00191                         VARS.ajouteVar(var)
<a name="l00192"></a>00192                         self.<a class="code" href="classplanificateur_1_1_etat.html#3e7203a87ad084a468ed6a952f56c6f0" title="dictionnaire { nom de proposition : variable de proposition }">varFinales</a>[prop] = var
<a name="l00193"></a>00193                         <span class="keywordflow">if</span> self.<a class="code" href="classplanificateur_1_1_etat.html#1ff6e1d23726a7782fd0da2260592dbf" title="numero de cet etat">no_etat</a> == 0:
<a name="l00194"></a>00194                                 var = libPSC.Variable(prop + <span class="stringliteral">" etat 0"</span>, [<span class="keyword">True</span>, <span class="keyword">False</span>])
<a name="l00195"></a>00195                                 VARS.ajouteVar(var)
<a name="l00196"></a>00196                                 self.<a class="code" href="classplanificateur_1_1_etat.html#2941298dab0a04ad2e25795a026de7fa" title="dictionnaire { nom de proposition : variable de proposition }">varInitiales</a>[prop] = var
<a name="l00197"></a>00197 
<a name="l00198"></a>00198         <span class="comment">## Retourne la liste des variables de propositions initiales </span>
<a name="l00199"></a>00199         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00200"></a><a class="code" href="classplanificateur_1_1_etat.html#1d5592e15b9c28dbd842dd53ab6e3ad6">00200</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_etat.html#1d5592e15b9c28dbd842dd53ab6e3ad6" title="Retourne la liste des variables de propositions initiales.">retourneVarInitiales</a>(self):
<a name="l00201"></a>00201                 <span class="keywordflow">return</span> self.<a class="code" href="classplanificateur_1_1_etat.html#2941298dab0a04ad2e25795a026de7fa" title="dictionnaire { nom de proposition : variable de proposition }">varInitiales</a>.values()
<a name="l00202"></a>00202 
<a name="l00203"></a>00203         <span class="comment">## Retourne la variable initiale correpondant a la Proposition passee en parametre</span>
<a name="l00204"></a>00204         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00205"></a>00205         <span class="comment"># @param[in] prop Proposition dont on veut la variable initiale</span>
<a name="l00206"></a><a class="code" href="classplanificateur_1_1_etat.html#72b25d66e110e709366beb4e6375d02e">00206</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_etat.html#72b25d66e110e709366beb4e6375d02e" title="Retourne la variable initiale correpondant a la Proposition passee en parametre.">retourneVarInitiale</a>(self, prop):
<a name="l00207"></a>00207                 <span class="keywordflow">return</span> self.<a class="code" href="classplanificateur_1_1_etat.html#2941298dab0a04ad2e25795a026de7fa" title="dictionnaire { nom de proposition : variable de proposition }">varInitiales</a>[prop]
<a name="l00208"></a>00208 
<a name="l00209"></a>00209         <span class="comment">## Retourne la liste des variables de propositions finales </span>
<a name="l00210"></a>00210         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00211"></a><a class="code" href="classplanificateur_1_1_etat.html#dcab32ced65f6a6a3583d0ee98d13697">00211</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_etat.html#dcab32ced65f6a6a3583d0ee98d13697" title="Retourne la liste des variables de propositions finales.">retourneVarFinales</a>(self):
<a name="l00212"></a>00212                 <span class="keywordflow">return</span> self.<a class="code" href="classplanificateur_1_1_etat.html#3e7203a87ad084a468ed6a952f56c6f0" title="dictionnaire { nom de proposition : variable de proposition }">varFinales</a>.values()
<a name="l00213"></a>00213 
<a name="l00214"></a>00214         <span class="comment">## Retourne la variable finale correpondant a la Proposition passee en parametre</span>
<a name="l00215"></a>00215         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00216"></a>00216         <span class="comment"># @param[in] prop Proposition dont on veut la variable finale</span>
<a name="l00217"></a><a class="code" href="classplanificateur_1_1_etat.html#9413ffb26aa5da41b21cf78d34e103cd">00217</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_etat.html#9413ffb26aa5da41b21cf78d34e103cd" title="Retourne la variable finale correpondant a la Proposition passee en parametre.">retourneVarFinale</a>(self, prop):
<a name="l00218"></a>00218                 <span class="keywordflow">return</span> self.<a class="code" href="classplanificateur_1_1_etat.html#3e7203a87ad084a468ed6a952f56c6f0" title="dictionnaire { nom de proposition : variable de proposition }">varFinales</a>[prop]
<a name="l00219"></a>00219 
<a name="l00220"></a>00220         <span class="comment">## Retourne la liste des operateurs </span>
<a name="l00221"></a>00221         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00222"></a><a class="code" href="classplanificateur_1_1_etat.html#67a1e49b46530082ffdb9a9d72f7d974">00222</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_etat.html#67a1e49b46530082ffdb9a9d72f7d974" title="Retourne la liste des operateurs.">retourneOperateurs</a>(self):
<a name="l00223"></a>00223                 <span class="keywordflow">return</span> self.<a class="code" href="classplanificateur_1_1_etat.html#fe87471e83a345fbb21ac581e924df96" title="dictionnaire { nom de l&amp;#39;operateur : variable d&amp;#39;operateur }">varOperateurs</a>.values()
<a name="l00224"></a>00224 
<a name="l00225"></a>00225         <span class="comment">## Retourne la variable correspondant a l'operateur passe en parametre</span>
<a name="l00226"></a>00226         <span class="comment"># @param[in] self reference automatique vers l'instance executant cette</span>
<a name="l00227"></a>00227         <span class="comment">#                                methode.</span>
<a name="l00228"></a>00228         <span class="comment"># @param[in] op l'operateur</span>
<a name="l00229"></a><a class="code" href="classplanificateur_1_1_etat.html#b8feed463d4ff1a347744b621fd46be4">00229</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_etat.html#b8feed463d4ff1a347744b621fd46be4" title="Retourne la variable correspondant a l&amp;#39;operateur passe en parametre.">retourneVarOperateur</a>(self, op):
<a name="l00230"></a>00230                 <span class="keywordflow">return</span> self.<a class="code" href="classplanificateur_1_1_etat.html#fe87471e83a345fbb21ac581e924df96" title="dictionnaire { nom de l&amp;#39;operateur : variable d&amp;#39;operateur }">varOperateurs</a>[op.nom]
<a name="l00231"></a>00231 
<a name="l00232"></a>00232         <span class="comment">## Retourne une representation en str</span>
<a name="l00233"></a>00233         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00234"></a><a class="code" href="classplanificateur_1_1_etat.html#f93ada724d411779db1d68677179c298">00234</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_etat.html#f93ada724d411779db1d68677179c298" title="Retourne une representation en str.">__str__</a>(self):
<a name="l00235"></a>00235                 strr = <span class="stringliteral">"Etat "</span>+str(self.<a class="code" href="classplanificateur_1_1_etat.html#1ff6e1d23726a7782fd0da2260592dbf" title="numero de cet etat">no_etat</a>)+<span class="stringliteral">"\n"</span>
<a name="l00236"></a>00236                 strr += <span class="stringliteral">"\t Propositions initiales :\n"</span>
<a name="l00237"></a>00237                 <span class="keywordflow">for</span> var <span class="keywordflow">in</span> self.<a class="code" href="classplanificateur_1_1_etat.html#1d5592e15b9c28dbd842dd53ab6e3ad6" title="Retourne la liste des variables de propositions initiales.">retourneVarInitiales</a>():
<a name="l00238"></a>00238                         strr+=<span class="stringliteral">"\t\t"</span>+str(var)+<span class="stringliteral">"\n"</span>
<a name="l00239"></a>00239                 
<a name="l00240"></a>00240                 strr += <span class="stringliteral">"\t Operateurs :\n"</span>
<a name="l00241"></a>00241                 <span class="keywordflow">for</span> op <span class="keywordflow">in</span> self.<a class="code" href="classplanificateur_1_1_etat.html#67a1e49b46530082ffdb9a9d72f7d974" title="Retourne la liste des operateurs.">retourneOperateurs</a>():
<a name="l00242"></a>00242                         strr+=<span class="stringliteral">"\t\t"</span>+str(op)+<span class="stringliteral">"\n"</span>
<a name="l00243"></a>00243 
<a name="l00244"></a>00244                 strr += <span class="stringliteral">"\t Propositions finales :\n"</span>
<a name="l00245"></a>00245                 <span class="keywordflow">for</span> var <span class="keywordflow">in</span> self.<a class="code" href="classplanificateur_1_1_etat.html#dcab32ced65f6a6a3583d0ee98d13697" title="Retourne la liste des variables de propositions finales.">retourneVarFinales</a>():
<a name="l00246"></a>00246                         strr+=<span class="stringliteral">"\t\t"</span>+str(var)+<span class="stringliteral">"\n"</span>
<a name="l00247"></a>00247                         
<a name="l00248"></a>00248                 <span class="keywordflow">return</span> strr
<a name="l00249"></a>00249                  
<a name="l00250"></a>00250                  
<a name="l00251"></a>00251 <span class="comment">## La classe representant le planning par modelisation PSC</span>
<a name="l00252"></a><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html">00252</a> <span class="keyword">class </span><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html" title="La classe representant le planning par modelisation PSC.">PlanificateurPSC</a>:
<a name="l00253"></a>00253 
<a name="l00254"></a>00254         <span class="comment">## \var probleme </span>
<a name="l00255"></a>00255         <span class="comment"># Le probleme de planification a resoudre</span>
<a name="l00256"></a>00256 
<a name="l00257"></a>00257         <span class="comment">## \var nb_etats </span>
<a name="l00258"></a>00258         <span class="comment"># Le nombre d'etats dans le plan, c'est a dire la longeur du plan</span>
<a name="l00259"></a>00259         
<a name="l00260"></a>00260         <span class="comment">## constructeur</span>
<a name="l00261"></a>00261         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00262"></a>00262         <span class="comment"># @param[in] prob Le probleme de planification </span>
<a name="l00263"></a>00263         <span class="comment"># @param[in] nb_etats nombre d'etats</span>
<a name="l00264"></a><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#bada311a661dc0c02b1ccd195707f8ab">00264</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#bada311a661dc0c02b1ccd195707f8ab" title="constructeur">__init__</a>(self, prob, nb_etats):
<a name="l00265"></a><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#27d267ec1dd9accf9cd1d8fe2541b4cd">00265</a>                 self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#27d267ec1dd9accf9cd1d8fe2541b4cd" title="Le probleme de planification a resoudre.">probleme</a> = prob
<a name="l00266"></a><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#973f035da0b5c394787170c3903657c2">00266</a>                 self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#973f035da0b5c394787170c3903657c2" title="Le nombre d&amp;#39;etats dans le plan, c&amp;#39;est a dire la longeur du plan.">nb_etats</a>=nb_etats
<a name="l00267"></a>00267                 del ETATS[:]
<a name="l00268"></a>00268                 
<a name="l00269"></a>00269         <span class="comment">## construit tous les etats de la planification</span>
<a name="l00270"></a>00270         <span class="comment"># Quand cette methode retourne, la liste globale ETATS doit etre rangee par ordre croissant du numero d'etat. </span>
<a name="l00271"></a>00271         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode                   </span>
<a name="l00272"></a><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#4d419ceaec6b6434b6141f193b1fda6c">00272</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#4d419ceaec6b6434b6141f193b1fda6c" title="construit tous les etats de la planification Quand cette methode retourne, la liste...">contruitEtats</a>(self):
<a name="l00273"></a>00273                 <span class="keywordflow">print</span> <span class="stringliteral">"|+|Construction des Etats "</span>
<a name="l00274"></a>00274                 <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0,self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#973f035da0b5c394787170c3903657c2" title="Le nombre d&amp;#39;etats dans le plan, c&amp;#39;est a dire la longeur du plan.">nb_etats</a>):
<a name="l00275"></a>00275                         <span class="keywordflow">print</span> <span class="stringliteral">"\tConstruction de l'etat : "</span>+str(i)
<a name="l00276"></a>00276                         etat= Etat(i, self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#27d267ec1dd9accf9cd1d8fe2541b4cd" title="Le probleme de planification a resoudre.">probleme</a>.retournePropositions(), self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#27d267ec1dd9accf9cd1d8fe2541b4cd" title="Le probleme de planification a resoudre.">probleme</a>.retourneOperateurs())
<a name="l00277"></a>00277                         ETATS.append(etat)
<a name="l00278"></a>00278 
<a name="l00279"></a>00279         <span class="comment">## Implemente les contraintes de mutex de propositions</span>
<a name="l00280"></a>00280         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00281"></a><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#a4158d8a3f1c751dee86977f045031bf">00281</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#a4158d8a3f1c751dee86977f045031bf" title="Implemente les contraintes de mutex de propositions.">implementeMutexDePropositions</a> (self): 
<a name="l00282"></a>00282                 <span class="keywordflow">for</span> mutex <span class="keywordflow">in</span> self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#27d267ec1dd9accf9cd1d8fe2541b4cd" title="Le probleme de planification a resoudre.">probleme</a>.retourneMutexDePropositions():
<a name="l00283"></a>00283                         <span class="keywordflow">for</span> etat <span class="keywordflow">in</span> ETATS:
<a name="l00284"></a>00284                                 CONTS.ajouteContrainte( libPSC.ContrainteBinaire(etat.retourneVarInitiale(mutex[0]), <span class="stringliteral">"NAND"</span>, etat.retourneVarInitiale(mutex[1])) )
<a name="l00285"></a>00285                                 <span class="keywordflow">if</span> etat.no_etat==(self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#973f035da0b5c394787170c3903657c2" title="Le nombre d&amp;#39;etats dans le plan, c&amp;#39;est a dire la longeur du plan.">nb_etats</a>-1):
<a name="l00286"></a>00286                                         CONTS.ajouteContrainte( libPSC.ContrainteBinaire(etat.retourneVarFinale(mutex[0]), <span class="stringliteral">"NAND"</span>, etat.retourneVarFinale(mutex[1])) )
<a name="l00287"></a>00287                 
<a name="l00288"></a>00288         <span class="comment">## Implemente les contraintes de mutex d'operateurs</span>
<a name="l00289"></a>00289         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00290"></a><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#808e80f821fcfac41c468a9df9c8d3a9">00290</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#808e80f821fcfac41c468a9df9c8d3a9" title="Implemente les contraintes de mutex d&amp;#39;operateurs.">implementeMutexDOperateurs</a> (self): 
<a name="l00291"></a>00291                 <span class="keywordflow">for</span> mutex <span class="keywordflow">in</span> self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#27d267ec1dd9accf9cd1d8fe2541b4cd" title="Le probleme de planification a resoudre.">probleme</a>.retourneMutexDOperateurs():
<a name="l00292"></a>00292                         <span class="keywordflow">for</span> etat <span class="keywordflow">in</span> ETATS:
<a name="l00293"></a>00293                                 CONTS.ajouteContrainte( libPSC.ContrainteBinaire(etat.retourneVarOperateur(mutex[0]), <span class="stringliteral">"NAND"</span>, etat.retourneVarOperateur(mutex[1])) )
<a name="l00294"></a>00294                 
<a name="l00295"></a>00295         <span class="comment">## Implemente les contraintes correspondant aux conditions initiales et finales:</span>
<a name="l00296"></a>00296         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00297"></a><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#7fc7e946b15ab4d7b5bba8791e65df85">00297</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#7fc7e946b15ab4d7b5bba8791e65df85" title="Implemente les contraintes correspondant aux conditions initiales et finales:.">implementeConditionsInitialesEtFinales</a> (self):
<a name="l00298"></a>00298                 <span class="keywordflow">for</span> cond <span class="keywordflow">in</span> self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#27d267ec1dd9accf9cd1d8fe2541b4cd" title="Le probleme de planification a resoudre.">probleme</a>.retourneConditionsInitiales():
<a name="l00299"></a>00299                         var = ETATS[0].retourneVarInitiale(cond[0])
<a name="l00300"></a>00300                         CONTS.ajouteContrainte( libPSC.ContrainteUnaire(var, <span class="stringliteral">"=="</span>, cond[1]) )
<a name="l00301"></a>00301                 <span class="keywordflow">for</span> cond <span class="keywordflow">in</span> self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#27d267ec1dd9accf9cd1d8fe2541b4cd" title="Le probleme de planification a resoudre.">probleme</a>.retourneConditionsFinales():
<a name="l00302"></a>00302                         var = ETATS[self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#973f035da0b5c394787170c3903657c2" title="Le nombre d&amp;#39;etats dans le plan, c&amp;#39;est a dire la longeur du plan.">nb_etats</a>-1].retourneVarFinale(cond[0])
<a name="l00303"></a>00303                         CONTS.ajouteContrainte( libPSC.ContrainteUnaire(var, <span class="stringliteral">"=="</span>, cond[1]) )
<a name="l00304"></a>00304                         
<a name="l00305"></a>00305         <span class="comment">## Implemente les contraintes de pre- et postconditions</span>
<a name="l00306"></a>00306         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00307"></a><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#8455e3eb212db1f95a090d7cd20407b4">00307</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#8455e3eb212db1f95a090d7cd20407b4" title="Implemente les contraintes de pre- et postconditions.">implementePreEtPostconditions</a>(self):
<a name="l00308"></a>00308                 <span class="keywordflow">for</span> et <span class="keywordflow">in</span> ETATS:
<a name="l00309"></a>00309                         <span class="keywordflow">for</span> op <span class="keywordflow">in</span> self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#27d267ec1dd9accf9cd1d8fe2541b4cd" title="Le probleme de planification a resoudre.">probleme</a>.retourneOperateurs():
<a name="l00310"></a>00310                                 <span class="keywordflow">for</span> pre <span class="keywordflow">in</span> op.retournePreconditions():
<a name="l00311"></a>00311                                         CONTS.ajouteContrainte( libPSC.ContrainteBinaire(et.retourneVarOperateur(op), <span class="stringliteral">"-&gt;"</span>, et.retourneVarInitiale(pre)) )
<a name="l00312"></a>00312                                 <span class="keywordflow">for</span> post <span class="keywordflow">in</span> op.retournePostconditions():
<a name="l00313"></a>00313                                         CONTS.ajouteContrainte( libPSC.ContrainteBinaire(et.retourneVarOperateur(op), <span class="stringliteral">"-&gt;"</span>, et.retourneVarFinale(post)) )
<a name="l00314"></a>00314                                                 
<a name="l00315"></a>00315         <span class="comment">## ajoute les contraintes d'axiomes de cadre</span>
<a name="l00316"></a>00316         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00317"></a><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#b6847676bcf9a34f67b9c1b680e47d20">00317</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#b6847676bcf9a34f67b9c1b680e47d20" title="ajoute les contraintes d&amp;#39;axiomes de cadre">implementeAxiomesDeCadre</a> (self):
<a name="l00318"></a>00318                 <span class="keywordflow">for</span> et <span class="keywordflow">in</span> ETATS:
<a name="l00319"></a>00319                         <span class="keywordflow">for</span> prop <span class="keywordflow">in</span> self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#27d267ec1dd9accf9cd1d8fe2541b4cd" title="Le probleme de planification a resoudre.">probleme</a>.retournePropositions():
<a name="l00320"></a>00320                                 
<a name="l00321"></a>00321                                 <span class="comment"># Genere la liste des variables d'operateurs qui ont prop comme postcondition</span>
<a name="l00322"></a>00322                                 varsOp = [ et.retourneVarOperateur(op) <span class="keywordflow">for</span> op <span class="keywordflow">in</span> self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#27d267ec1dd9accf9cd1d8fe2541b4cd" title="Le probleme de planification a resoudre.">probleme</a>.retourneOperateurs() 
<a name="l00323"></a>00323                                                                                                                 <span class="keywordflow">if</span> op.aPourPostcondition(prop) ]
<a name="l00324"></a>00324                                 
<a name="l00325"></a>00325                                 c = ContrainteAxiomeCadre( et.retourneVarInitiale(prop), varsOp, et.retourneVarFinale(prop) )
<a name="l00326"></a>00326                                 CONTS.ajouteContrainte(c)
<a name="l00327"></a>00327                                 
<a name="l00328"></a>00328 
<a name="l00329"></a>00329         <span class="comment">## Implemente le PSC a partir du probleme de planification</span>
<a name="l00330"></a>00330         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00331"></a><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#c0ffb2e39632ff1366c95ccf33adfc7d">00331</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#c0ffb2e39632ff1366c95ccf33adfc7d" title="Implemente le PSC a partir du probleme de planification.">implementePSC</a> (self):
<a name="l00332"></a>00332                 self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#4d419ceaec6b6434b6141f193b1fda6c" title="construit tous les etats de la planification Quand cette methode retourne, la liste...">contruitEtats</a>()
<a name="l00333"></a>00333                 afficheEtats()
<a name="l00334"></a>00334                 self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#a4158d8a3f1c751dee86977f045031bf" title="Implemente les contraintes de mutex de propositions.">implementeMutexDePropositions</a>()
<a name="l00335"></a>00335                 self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#808e80f821fcfac41c468a9df9c8d3a9" title="Implemente les contraintes de mutex d&amp;#39;operateurs.">implementeMutexDOperateurs</a>()
<a name="l00336"></a>00336                 self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#7fc7e946b15ab4d7b5bba8791e65df85" title="Implemente les contraintes correspondant aux conditions initiales et finales:.">implementeConditionsInitialesEtFinales</a>()
<a name="l00337"></a>00337                 self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#8455e3eb212db1f95a090d7cd20407b4" title="Implemente les contraintes de pre- et postconditions.">implementePreEtPostconditions</a>()
<a name="l00338"></a>00338                 self.<a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#b6847676bcf9a34f67b9c1b680e47d20" title="ajoute les contraintes d&amp;#39;axiomes de cadre">implementeAxiomesDeCadre</a>()
<a name="l00339"></a>00339                 
<a name="l00340"></a>00340 
<a name="l00341"></a>00341         <span class="comment">## Affiche les variables et les contraintes        </span>
<a name="l00342"></a>00342         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00343"></a><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#3a6a6833a706567f96b8ce145e217919">00343</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#3a6a6833a706567f96b8ce145e217919" title="Affiche les variables et les contraintes.">affichePSC</a>(self):
<a name="l00344"></a>00344                 <span class="keywordflow">print</span> VARS.__repr__()
<a name="l00345"></a>00345                 <span class="keywordflow">print</span> CONTS.__repr__()
<a name="l00346"></a>00346                 afficheNombreVarsEtContraintes()
<a name="l00347"></a>00347         
<a name="l00348"></a>00348         <span class="comment">## Trouve la solution en utilsant le Forward Checking</span>
<a name="l00349"></a>00349         <span class="comment"># @param[in] self reference automatique sur l'objet qui execute cette methode</span>
<a name="l00350"></a><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#01bec931fb1cb3b87372d3de3c0cceec">00350</a>         <span class="keyword">def </span><a class="code" href="classplanificateur_1_1_planificateur_p_s_c.html#01bec931fb1cb3b87372d3de3c0cceec" title="Trouve la solution en utilsant le Forward Checking.">trouveLaSolution</a>(self):
<a name="l00351"></a>00351                 
<a name="l00352"></a>00352                 <span class="comment"># consistance des noeuds + arcs</span>
<a name="l00353"></a>00353                 <span class="keywordflow">print</span> <span class="stringliteral">"|+| Fait la consistance des noeuds"</span>
<a name="l00354"></a>00354                 VARS.consistanceDesNoeuds()
<a name="l00355"></a>00355                 <span class="keywordflow">print</span> <span class="stringliteral">"|+| Fait la consistance des arcs"</span>
<a name="l00356"></a>00356                 CONTS.consistanceDesArcs()
<a name="l00357"></a>00357                 afficheEtats()
<a name="l00358"></a>00358 
<a name="l00359"></a>00359                 afficheNombreVarsEtContraintes()
<a name="l00360"></a>00360                 <span class="keywordflow">print</span> <span class="stringliteral">"|+| Applique l'heuristique Variable Ordering"</span>
<a name="l00361"></a>00361                 PSC.variableOrdering()
<a name="l00362"></a>00362                 
<a name="l00363"></a>00363                 <span class="keywordflow">print</span> <span class="stringliteral">"|+| Applique le Forward Checking"</span>
<a name="l00364"></a>00364 <span class="comment">#               sol = PSC.backtrack(0, False)</span>
<a name="l00365"></a>00365                 sol = PSC.forwardChecking(0, <span class="keyword">False</span>, <span class="keyword">True</span>)
<a name="l00366"></a>00366                 <span class="keywordflow">if</span> sol!=PSC.ECHEC:
<a name="l00367"></a>00367                         afficheUneSolutionPossible()
<a name="l00368"></a>00368                 <span class="keywordflow">else</span>:
<a name="l00369"></a>00369                         <span class="keywordflow">print</span> <span class="stringliteral">"|-| Aucune solution trouvee"</span>
<a name="l00370"></a>00370 
<a name="l00371"></a>00371 
<a name="l00372"></a>00372 <span class="comment">## Affiche la solution trouvee</span>
<a name="l00373"></a><a class="code" href="namespaceplanificateur.html#df0487e95201ce444ed5e001e422fa8b">00373</a> <span class="keyword">def </span><a class="code" href="namespaceplanificateur.html#df0487e95201ce444ed5e001e422fa8b" title="Affiche la solution trouvee.">afficheUneSolutionPossible</a>():
<a name="l00374"></a>00374         <span class="keywordflow">print</span> <span class="stringliteral">"|+| Solution trouvee:=\n"</span>
<a name="l00375"></a>00375         <span class="keywordflow">for</span> et <span class="keywordflow">in</span> ETATS:
<a name="l00376"></a>00376                 <span class="keywordflow">print</span> et
<a name="l00377"></a>00377                         
<a name="l00378"></a>00378 <span class="comment">## Affiche les etats</span>
<a name="l00379"></a><a class="code" href="namespaceplanificateur.html#00dd01a88298b46eefdfa7f0d52da1f8">00379</a> <span class="keyword">def </span><a class="code" href="namespaceplanificateur.html#00dd01a88298b46eefdfa7f0d52da1f8" title="Affiche les etats.">afficheEtats</a>():
<a name="l00380"></a>00380         <span class="keywordflow">for</span> et <span class="keywordflow">in</span> ETATS:
<a name="l00381"></a>00381                 <span class="keywordflow">print</span> et
<a name="l00382"></a>00382 
<a name="l00383"></a>00383 <span class="comment">## Affiche le nombre de Variabless et de Contraintes</span>
<a name="l00384"></a><a class="code" href="namespaceplanificateur.html#582b953b2a95a985b8b6f7a011154d41">00384</a> <span class="keyword">def </span><a class="code" href="namespaceplanificateur.html#582b953b2a95a985b8b6f7a011154d41" title="Affiche le nombre de Variabless et de Contraintes.">afficheNombreVarsEtContraintes</a>():
<a name="l00385"></a>00385         <span class="keywordflow">print</span> <span class="stringliteral">"|+| Nombre de Variables :"</span>+str(VARS.retourneNbVars())
<a name="l00386"></a>00386         <span class="keywordflow">print</span> <span class="stringliteral">"|+| Nombre de Contraintes        :"</span>+str(CONTS.retourneNbContraintes())
<a name="l00387"></a>00387         
<a name="l00388"></a>00388 exec file(<span class="stringliteral">"missionnaires.py"</span>)
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Généré le Thu Oct 2 12:59:29 2008 pour Lab 7 : Planification avec PSC par&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
